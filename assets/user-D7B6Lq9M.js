import{D as a}from"./index-7XoPJpAS.js";const m=a("user",{state:()=>({user:null,dummyUser:null,cardNumber:0}),getters:{username:e=>{var r;return((r=e.user)==null?void 0:r.username)||""},userImage:e=>{var r;return((r=e.user)==null?void 0:r.image)||""},cardNumberDisplay:e=>e.cardNumber||"Chưa có"},actions:{setUser(e){this.user=e,localStorage.setItem("user",JSON.stringify(e))},loadUserFromLocalStorage(){const e=localStorage.getItem("user");e&&(this.user=JSON.parse(e))},async fetchDummyUserById(e){try{const s=await(await fetch("https://dummyjson.com/users")).json();this.dummyUser=s.users.find(t=>t.id===e)||null}catch(r){console.error("Lỗi khi lấy dummy user:",r),this.dummyUser=null}},async initUser(){var e,r,s;this.loadUserFromLocalStorage(),this.user&&(await this.fetchDummyUserById(this.user.id),(r=(e=this.dummyUser)==null?void 0:e.bank)!=null&&r.cardNumber?this.cardNumber=Number(this.dummyUser.bank.cardNumber):this.cardNumber=((s=this.user.bank)==null?void 0:s.cardNumber)||0)},register(e){const r={...e,id:Date.now(),bank:{cardNumber:Date.now()}};this.setUser(r)}}});export{m as u};
